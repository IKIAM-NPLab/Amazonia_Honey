####### Script to calculate RI #######

# Installation of R package to calculate linear retention index (RI).

# Installation of "MetaboCoreUtils" package
#install.packages("remotes")
#remotes::install_github("rformassspectrometry/MetaboCoreUtils")

# Loading "MetaboCoreUtils" library
library("MetaboCoreUtils")

## Loadding rt of each n-alkane
rtime_ids <- c(3.750, 5.312, 7.154, 9.065, 10.937, 12.727, 14.380, 15.710,
               16.805, 17.818)
rindex_ids <- c(800, 900, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700)
rti_ids <- data.frame(rtime = rtime_ids, rindex = rindex_ids)

## Experimental Retention Index (RI) calculation
##Feature deconvoluted with eRah
rtime_erah <- c(3.7682, 5.3619, 5.5595, 6.1097, 6.2072, 6.3753, 6.5075, 6.5077,
                6.5085, 6.5086, 6.6157, 6.6161, 7.665, 7.8605, 7.8673, 7.9715,
                8.0378, 8.0378, 8.3538, 8.4746, 8.5572, 8.5574, 8.56, 8.5642,
                8.5878, 8.8585, 8.8614, 8.9128, 9.0958,  9.1327,  9.1349,
                9.1453, 9.3815, 9.4153, 9.4166, 9.4568, 9.6515, 9.8685, 10.0435,
                10.0596, 10.1539, 10.2975, 10.4101, 10.4201, 10.5925, 10.7582,
                10.8642, 11.08, 11.1031, 11.3527, 11.7107, 12.017, 12.4946,
                13.5455, 13.5489, 13.5625, 13.5625, 14.4877, 14.6574, 15.3901,
                15.625, 15.6803, 15.7859, 16.0675, 17.4288, 17.8153, 18.0943)
indexRtime(rtime_erah, rti_ids)
##Feature deconvoluted with MZmine
rtime_mzmine <- c(5.010, 5.152, 5.329, 5.348, 5.355, 5.355, 5.356, 5.358, 5.365,
                  5.365, 5.935, 5.955, 6.000, 6.086, 6.208, 6.370, 6.4974,
                  6.537, 6.599, 6.606, 6.645, 6.995, 6.995, 7.475, 7.844,
                  7.844, 8.031, 8.350, 8.467, 8.500, 8.548, 8.597, 8.853, 8.910,
                  8.915, 9.060, 9.127, 9.157, 9.345, 9.406, 9.430, 9.473, 9.613,
                  9.643, 9.863, 10.023, 10.050, 10.057, 10.057, 10.065, 10.104,
                  10.120, 10.143, 10.260, 10.263, 10.390, 10.392, 10.392,
                  10.395, 10.400, 10.415, 10.455, 10.744, 10.744, 10.750,
                  10.857, 10.920, 11.095, 11.258, 11.690, 11.700, 12.006,
                  12.030, 12.479, 13.538, 13.556, 13.560, 13.975, 14.370,
                  14.480, 14.490, 14.649, 14.885, 15.384, 15.385, 15.386,
                  15.390, 15.622, 15.659, 15.697, 15.700, 16.065, 16.328,
                  16.330, 16.615, 17.325, 17.326, 17.420, 17.428, 17.430,
                  17.585, 18.080)
indexRtime(rtime_mzmine, rti_ids)
##Feature deconvoluted with MSHub
rtime_mshub <- c(3.760, 3.760, 3.950, 4.010, 4.050, 4.110, 4.110, 4.280, 4.370,
                 4.450, 4.450, 4.530, 4.650, 4.650, 4.730, 4.730, 4.730, 4.730,
                 4.930, 5.370, 5.370, 5.510, 5.550, 5.550, 5.970, 5.970, 6.090,
                 6.380, 6.540, 6.540, 7.000, 7.280, 7.830, 7.950, 7.950, 8.030,
                 8.350, 8.350, 8.460, 8.550, 8.730, 8.850, 8.910, 8.910, 9.040,
                 9.130, 9.270, 9.380, 9.440, 9.480, 9.650, 9.710, 9.870, 10.060,
                 10.140, 10.300, 10.410, 10.410, 10.460, 10.750, 10.860, 11.100,
                 11.340, 11.710, 11.840, 11.930, 12.030, 12.340, 12.480, 12.480,
                 13.240, 13.540, 14.490, 14.650, 15.190, 15.390, 15.450, 16.060,
                 16.060, 16.180, 17.340, 17.430, 17.500)
indexRtime(rtime_mshub, rti_ids)

